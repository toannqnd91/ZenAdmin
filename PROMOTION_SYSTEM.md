# Há»‡ Thá»‘ng Khuyáº¿n MÃ£i & Voucher - POS

## Tá»•ng Quan

Há»‡ thá»‘ng khuyáº¿n mÃ£i thÃ´ng minh Ä‘Æ°á»£c tÃ­ch há»£p vÃ o mÃ n hÃ¬nh POS vá»›i cÃ¡c tÃ­nh nÄƒng:

### âœ¨ TÃ­nh NÄƒng ChÃ­nh

1. **Khuyáº¿n mÃ£i tá»± Ä‘á»™ng (Buy X Get Y)**
   - Mua 10 sáº£n pháº©m táº·ng 1
   - Mua 5 cÃ  phÃª táº·ng 1 bÃ¡nh
   - Mua 3 trÃ  sá»¯a táº·ng 1 trÃ  sá»¯a
   - Tá»± Ä‘á»™ng tÃ­nh toÃ¡n vÃ  thÃªm sáº£n pháº©m táº·ng kÃ¨m vÃ o giá» hÃ ng

2. **MÃ£ giáº£m giÃ¡/Voucher**
   - Nháº­p mÃ£ voucher Ä‘á»ƒ giáº£m giÃ¡
   - Hiá»ƒn thá»‹ danh sÃ¡ch voucher kháº£ dá»¥ng
   - Kiá»ƒm tra Ä‘iá»u kiá»‡n tá»‘i thiá»ƒu
   - Kiá»ƒm tra háº¡n sá»­ dá»¥ng

3. **Combo/Bundle Deals**
   - Mua combo sáº£n pháº©m vá»›i giÃ¡ Æ°u Ä‘Ã£i
   - Tá»± Ä‘á»™ng Ã¡p dá»¥ng khi Ä‘á»§ Ä‘iá»u kiá»‡n

4. **Giáº£m giÃ¡ theo tá»•ng Ä‘Æ¡n**
   - Giáº£m % hoáº·c sá»‘ tiá»n cá»‘ Ä‘á»‹nh
   - Ãp dá»¥ng khi Ä‘Æ¡n hÃ ng Ä‘áº¡t giÃ¡ trá»‹ tá»‘i thiá»ƒu

## ğŸ¯ CÃ¡ch Sá»­ Dá»¥ng

### Khuyáº¿n MÃ£i Tá»± Äá»™ng

Khuyáº¿n mÃ£i Ä‘Æ°á»£c tá»± Ä‘á»™ng Ã¡p dá»¥ng khi:
- ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng
- Thay Ä‘á»•i sá»‘ lÆ°á»£ng sáº£n pháº©m
- XÃ³a sáº£n pháº©m khá»i giá» hÃ ng

**Sáº£n pháº©m táº·ng kÃ¨m:**
- ÄÆ°á»£c Ä‘Ã¡nh dáº¥u vá»›i badge "Táº¶NG KÃˆM" mÃ u há»“ng-tÃ­m
- CÃ³ viá»n há»“ng xung quanh hÃ¬nh áº£nh
- Hiá»ƒn thá»‹ "x[sá»‘ lÆ°á»£ng] (Tá»± Ä‘á»™ng)"
- KhÃ´ng thá»ƒ chá»‰nh sá»­a sá»‘ lÆ°á»£ng thá»§ cÃ´ng
- Tá»± Ä‘á»™ng cáº­p nháº­t khi thay Ä‘á»•i sáº£n pháº©m mua

### MÃ£ Giáº£m GiÃ¡

1. Click nÃºt **"Nháº­p mÃ£ giáº£m giÃ¡"** (mÃ u tÃ­m) trong giá» hÃ ng
2. Chá»n voucher tá»« danh sÃ¡ch hoáº·c nháº­p mÃ£ thá»§ cÃ´ng
3. Há»‡ thá»‘ng kiá»ƒm tra:
   - MÃ£ cÃ³ há»£p lá»‡ khÃ´ng
   - ÄÆ¡n hÃ ng cÃ³ Ä‘áº¡t giÃ¡ trá»‹ tá»‘i thiá»ƒu khÃ´ng
   - MÃ£ cÃ³ háº¿t háº¡n khÃ´ng
4. Click "Ãp dá»¥ng" Ä‘á»ƒ sá»­ dá»¥ng voucher

**Voucher máº«u:**
- `SUMMER2024`: Giáº£m 15% (tá»‘i Ä‘a 100k) cho Ä‘Æ¡n tá»« 200k
- `NEWCUSTOMER`: Giáº£m 50k cho Ä‘Æ¡n tá»« 100k
- `VIP100K`: Giáº£m 100k cho Ä‘Æ¡n tá»« 500k
- `FLASH20`: Giáº£m 20% (tá»‘i Ä‘a 150k) cho Ä‘Æ¡n tá»« 300k

### Xem Khuyáº¿n MÃ£i Äang Ãp Dá»¥ng

Trong giá» hÃ ng, báº¡n sáº½ tháº¥y:

1. **Khuyáº¿n mÃ£i Ä‘ang Ã¡p dá»¥ng** - Card mÃ u há»“ng hiá»ƒn thá»‹:
   - TÃªn chÆ°Æ¡ng trÃ¬nh
   - MÃ´ táº£ chi tiáº¿t
   - Danh sÃ¡ch quÃ  táº·ng (náº¿u cÃ³)
   - Sá»‘ tiá»n giáº£m (náº¿u cÃ³)

2. **Khuyáº¿n mÃ£i sáº¯p Ä‘áº¡t Ä‘Æ°á»£c** - Card mÃ u xanh hiá»ƒn thá»‹:
   - CÃ¡c chÆ°Æ¡ng trÃ¬nh chÆ°a Ä‘á»§ Ä‘iá»u kiá»‡n
   - Gá»£i Ã½ cáº§n mua thÃªm bao nhiÃªu Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c

## ğŸ”§ Cáº¥u HÃ¬nh Khuyáº¿n MÃ£i

### File: `app/utils/promotionEngine.ts`

```typescript
export const mockPromotions: Promotion[] = [
  {
    id: 'PROMO001',
    name: 'Mua 10 táº·ng 1',
    type: 'buy_x_get_y',
    active: true,
    priority: 10,
    conditions: {
      buyQuantity: 10,
      buyProductIds: [], // Rá»—ng = Ã¡p dá»¥ng cho táº¥t cáº£
      buyCategories: []
    },
    rewards: {
      giftQuantity: 1,
      giftProductIds: [] // Rá»—ng = táº·ng cÃ¹ng sáº£n pháº©m
    }
  }
]
```

### CÃ¡c Loáº¡i Khuyáº¿n MÃ£i

#### 1. Buy X Get Y
```typescript
{
  type: 'buy_x_get_y',
  conditions: {
    buyQuantity: 5,           // Mua 5
    buyCategories: ['CÃ  phÃª'] // Trong danh má»¥c CÃ  phÃª
  },
  rewards: {
    giftQuantity: 1,          // Táº·ng 1
    giftProductIds: [60, 61]  // Sáº£n pháº©m ID 60 hoáº·c 61
  }
}
```

#### 2. Total Discount
```typescript
{
  type: 'total_discount',
  conditions: {
    minTotalAmount: 500000    // ÄÆ¡n tá»‘i thiá»ƒu 500k
  },
  rewards: {
    discountType: 'percent',  // Hoáº·c 'amount'
    discountValue: 10,        // 10%
    maxDiscount: 100000       // Tá»‘i Ä‘a 100k
  }
}
```

#### 3. Bundle
```typescript
{
  type: 'bundle',
  conditions: {
    requiredProducts: [
      { productId: 43, quantity: 1 },
      { productId: 44, quantity: 1 }
    ]
  },
  rewards: {
    bundlePrice: 90000        // GiÃ¡ combo (thay vÃ¬ 105k)
  }
}
```

## ğŸ’¡ Æ¯u TiÃªn Khuyáº¿n MÃ£i

Khuyáº¿n mÃ£i Ä‘Æ°á»£c Ã¡p dá»¥ng theo thá»© tá»± Æ°u tiÃªn (priority):
- Sá»‘ cÃ ng cao = Æ°u tiÃªn cÃ ng cao
- Nhiá»u khuyáº¿n mÃ£i cÃ³ thá»ƒ Ã¡p dá»¥ng cÃ¹ng lÃºc
- Giáº£m giÃ¡ Ä‘Æ°á»£c cá»™ng dá»“n

## ğŸ¨ Giao Diá»‡n

### MÃ u Sáº¯c
- **Voucher**: TÃ­m-Há»“ng gradient
- **Khuyáº¿n mÃ£i**: Há»“ng-TÃ­m gradient
- **Sáº£n pháº©m táº·ng**: Há»“ng pastel background
- **Badge táº·ng kÃ¨m**: Gradient há»“ng-tÃ­m

### Icons
- ğŸ Gift icon cho sáº£n pháº©m táº·ng
- ğŸŸï¸ Ticket icon cho voucher
- âœ“ Checkmark cho Ä‘Ã£ Ã¡p dá»¥ng

## ğŸ“Š TÃ­nh ToÃ¡n Giáº£m GiÃ¡

Tá»•ng giáº£m giÃ¡ = Giáº£m giÃ¡ thá»§ cÃ´ng + Giáº£m giÃ¡ khuyáº¿n mÃ£i + Giáº£m giÃ¡ voucher

1. **Giáº£m giÃ¡ thá»§ cÃ´ng**: Tá»« modal giáº£m giÃ¡ (F6)
2. **Giáº£m giÃ¡ khuyáº¿n mÃ£i**: Tá»± Ä‘á»™ng tá»« cÃ¡c chÆ°Æ¡ng trÃ¬nh
3. **Giáº£m giÃ¡ voucher**: Tá»« mÃ£ voucher Ä‘Ã£ nháº­p

## ğŸ”„ Cáº­p Nháº­t Tá»± Äá»™ng

Há»‡ thá»‘ng tá»± Ä‘á»™ng:
- TÃ­nh toÃ¡n láº¡i khuyáº¿n mÃ£i khi giá» hÃ ng thay Ä‘á»•i
- ThÃªm/xÃ³a sáº£n pháº©m táº·ng kÃ¨m
- Cáº­p nháº­t sá»‘ lÆ°á»£ng quÃ  táº·ng
- Kiá»ƒm tra Ä‘iá»u kiá»‡n voucher

## ğŸš€ TÃ­ch Há»£p API (Production)

Trong production, thay tháº¿ mock data báº±ng API calls:

```typescript
// Fetch promotions from API
const { data: promotions } = await $fetch('/api/promotions/active')

// Validate voucher
const { data: voucher } = await $fetch('/api/vouchers/validate', {
  method: 'POST',
  body: { code: voucherCode, total: cartTotal }
})
```

## ğŸ“ Ghi ChÃº

- Sáº£n pháº©m táº·ng kÃ¨m cÃ³ giÃ¡ = 0
- KhÃ´ng thá»ƒ chá»‰nh sá»­a sá»‘ lÆ°á»£ng sáº£n pháº©m táº·ng
- XÃ³a sáº£n pháº©m mua sáº½ tá»± Ä‘á»™ng xÃ³a quÃ  táº·ng
- Voucher vÃ  khuyáº¿n mÃ£i cÃ³ thá»ƒ dÃ¹ng cÃ¹ng lÃºc
- Æ¯u tiÃªn cao hÆ¡n Ä‘Æ°á»£c Ã¡p dá»¥ng trÆ°á»›c

## ğŸ¯ Keyboard Shortcuts

- `F6`: Má»Ÿ modal giáº£m giÃ¡ thá»§ cÃ´ng
- Click vÃ o voucher button: Má»Ÿ modal voucher

## ğŸ” Quyá»n Háº¡n

Trong production, cÃ³ thá»ƒ giá»›i háº¡n:
- Chá»‰ manager má»›i Ä‘Æ°á»£c táº¡o/sá»­a khuyáº¿n mÃ£i
- Giá»›i háº¡n sá»‘ láº§n sá»­ dá»¥ng voucher
- Giá»›i háº¡n voucher theo khÃ¡ch hÃ ng
- Log láº¡i lá»‹ch sá»­ sá»­ dá»¥ng voucher
